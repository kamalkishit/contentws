'use strict';

var path = require('path');

var models = require('cws-models');
var logger = require('cws-logger');

var filename = 'ContentCreationService';

var Content = models.getContentModel();

exports.createDocument = function(scrapedData, contentCategory, documentId, userId) {
	var promise = new Promise(function(resolve, reject) {
		if (!scrapedData) {
			logger.error(filename, 'createDocument:' + 'scrapedData is null');
			reject(new Error('scrapedData is null'));
		}

		if (!contentCategory) {
			logger.error(filename, 'createDocument:' + 'contentCategory is null');
			reject(new Error('contentCategory is null'));
		}

		if (!documentId) {
			logger.error(filename, 'createDocument:' + 'documentId is null');
			reject(new Error('documentId is null'));
		}

		if (!userId) {
			logger.error(filename, 'createDocument:' + 'userId is null');
			reject(new Error('userId is null'));
		}

		var contentDocument = new Content({
			contentId: documentId,
			contentURL: scrapedData.url,
			userId: userId,
			ogTitle: scrapedData.title,
			ogDescription: scrapedData.description,
			ogSiteName: scrapedData.site_name,
			ogImageURL: scrapedData.image.url,
			imageURL: documentId + path.extname(scrapedData.image.url),
			category: contentCategory
		});

		resolve(contentDocument);
	});

	return promise;
};