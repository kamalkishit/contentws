'use strict';

var databaseService = require('cws-database-service');
var logger = require('cws-logger');
var models = require('cws-models');
var uniqueIdGenerator = require('cws-unique-id-generator');

var filename = 'SignUpService';

var User = models.getUserModel();

exports.signup = function(emailId, password) {
	var promise = new Promise(function(resolve, reject) {
		if (!emailId) {
			logger.error(filename, 'signup:' + 'emailId is null');
			reject(new Error('emailId is null'));
		}

		if (!password) {
			logger.error(filename, 'signup:' + 'password is null');
			reject(new Error('password is null'));
		}

		var user = new User({
			userId: uniqueIdGenerator.getUniqueId(),
			emailId: emailId,
			password: password
		});

		databaseService.save(user)
			.then(function(success) {
				logger.info(filename, 'signup:' + 'user created successfully');
				resolve('user created succefully');
			}, function(err) {
				logger.error(filename, 'signup:' + err);
				reject(new Error(err));
			});
	});

	return promise;
};